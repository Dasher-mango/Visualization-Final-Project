<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>D3.js State Map with Zoom and Text</title>
    <script src="../js/d3.v5.min.js"></script>
</head>
<body>

<script>
    // Load GeoJSON file and draw the map
    d3.json('geo.json')
        .then(function(data) {
            drawMap(data);
        })
        .catch(function(error) {
            console.error('Error loading GeoJSON file:', error);
        });

    // Function to draw the map
    function drawMap(geojson) {
        // Set up SVG container
        const svg = d3.select('body').append('svg')
            .attr('width', 800)
            .attr('height', 600);

        // Create a path generator
        const path = d3.geoPath();

        // Create a zoom behavior
        const zoom = d3.zoom()
            .scaleExtent([1, 8]) // Set the minimum and maximum zoom levels
            .on('zoom', zoomed);

        // Apply the zoom behavior to the SVG container
        svg.call(zoom);

        // Draw the states
        const states = svg.selectAll('path')
            .data(geojson.features)
            .enter().append('path')
            .attr('d', path)
            .attr('fill', 'lightgray')
            .attr('stroke', 'white');

        // Add state names as text with individual IDs
        const textElements = svg.selectAll('text')
            .data(geojson.features)
            .enter().append('text')
            .attr('class', 'state-label')  // Add a class for styling
            .attr('dy', '.35em')
            .style('text-anchor', 'middle')
            .text(function(d) {
                return d.properties.name;
            });

        // Function to update the transform on zoom
        function zoomed(event) {
            // Update the transform of the states
            states.attr('transform', event.transform);

            // Update the transform of the text elements
            textElements.attr('transform', function(d) {
                const centroid = path.centroid(d);
                const [x, y] = event.transform.apply(centroid);
                return `translate(${x}, ${y}) scale(${event.transform.k})`;
            });
        }
    }
</script>

</body>
</html>
